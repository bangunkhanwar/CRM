<?php defined('BASEPATH') OR exit('No direct script access allowed'); ?>

ERROR - 2020-03-13 11:50:25 --> Severity: Warning --> pg_query(): Query failed: ERROR:  syntax error at or near &quot;MIN1&quot;
LINE 4: ...L&quot;.&quot;STOCKMINLV1&quot;) AND T_ALL.&quot;PRODUCTTYPE&quot;=2 THEN 'MIN1'    W...
                                                             ^ /home/elcorps/crm/adm/system/database/drivers/postgre/postgre_driver.php 242
ERROR - 2020-03-13 11:50:25 --> Query error: ERROR:  syntax error at or near "MIN1"
LINE 4: ...L"."STOCKMINLV1") AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN1'    W...
                                                             ^ - Invalid query: SELECT "tbl".*
FROM "member"."Member" "tbl"
WHERE (
			UPPER("MemberCode") LIKE '%		SELECT T_FINAL.* 		FROM 		(SELECT T_ALL.*,  			CAST(CASE  			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO" > T_ALL."STOCKMIN" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" <= "T_ALL"."STOCKMINLV1") AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN1' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO" = "T_ALL"."STOCKMINLV2" AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN2' 			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO"> = "T_ALL"."STOCKMINLV3" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" < "T_ALL"."STOCKMINLV2") AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MIN3' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO"<T_ALL."STOCKMINLV3" AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN4' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO" = "T_ALL"."STOCKMAXLV1" AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MAX1' 			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO" > T_ALL."STOCKMAXLV1" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" <= "T_ALL"."STOCKMAXLV2") AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MAX2' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO">T_ALL."STOCKMAXLV2" AND T_ALL."PRODUCTTYPE"=2 THEN 'MAX3' 			ELSE '' 	END AS VARCHAR(16)) "STYPE" 		FROM 		(SELECT CAST(0 AS INTEGER) AS NRECNO 			,M_CAT."DESCRIPTION" "CATDESC" 			,TBL."SKU" 			,MP."DESCRIPTION" 			,TBL."GROSSSALES" 			,TBL."ENDQTY" 			,M_PRDS."STOCKMIN" 			,M_PRDS."STOCKMAX" 			,CAST(CASE WHEN M_PRDS."STOCKMAX"-TBL."ENDQTY"-COALESCE(T_APO."QUANTITY",0) < 0 THEN 0 				ELSE M_PRDS."STOCKMAX"-TBL."ENDQTY"-COALESCE(T_APO."QUANTITY",0) END AS NUMERIC(16)) AS "QTYORDER" 			,COALESCE(T_APO."QUANTITY",0) "QTYAPO" 			,CAST(TBL."GROSSSALES" * TBL."ENDQTY" AS NUMERIC(25,2)) AS "TOTAL" 			,TBL."TRANSDATE"			 			,M_CLASS."DESCRIPTION" "CLASSDESC" 			,M_STY."DESCRIPTION" "STYLEDESC" 			,M_ART."DESCRIPTION" "ARTICLEDESC" 			,CAST(M_PRDS."STOCKMIN"*1.2 AS NUMERIC(16))"STOCKMINLV1" 			,CAST(M_PRDS."STOCKMIN"*1 AS NUMERIC(16))"STOCKMINLV2" 			,CAST(M_PRDS."STOCKMIN"*0.8 AS NUMERIC(16))"STOCKMINLV3" 			,CAST(M_PRDS."STOCKMAX"*1 AS NUMERIC(16))"STOCKMAXLV1" 			,CAST(M_PRDS."STOCKMAX"*1.5 AS NUMERIC(16))"STOCKMAXLV2"		 			,MP."PRODUCTTYPE" 			FROM (SELECT * 			FROM "TRSTOCK" 				WHERE "STORECODE" = 'Z022') TBL 	JOIN (SELECT "SKU",MAX("TRANSDATE") AS "TRANSDATE" 			FROM "TRSTOCK" 			WHERE "TRANSDATE" < = '20200313' 				AND "STORECODE" = 'Z022' 			GROUP BY "SKU") PERIOD 		ON TBL."SKU" = "PERIOD"."SKU" AND "TBL"."TRANSDATE"" = PERIOD"."TRANSDATE"" LEFT JOIN ""MSPRODUCT"" MP ON TBL"."SKU"" = MP"."SKU"" LEFT JOIN ""MSPRODUCTCATEGORY"" M_CAT ON MP"."FIDPRODUCTCATEGORY"" = M_CAT"."IDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTMCLASS"" M_CLASS ON" "MP"."FIDPRODUCTMCLASS" = "M_CLASS"."IDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_CLASS"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTSTYLE"" M_STY ON" "MP"."FIDPRODUCTSTYLE" = "M_STY"."IDPRODUCTSTYLE" 			AND "MP"."FIDPRODUCTMCLASS" = "M_STY"."FIDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_STY"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTARTICLE"" M_ART ON" "MP"."FIDPRODUCTARTICLE" = "M_ART"."IDPRODUCTARTICLE" 			AND "MP"."FIDPRODUCTSTYLE" = "M_ART"."FIDPRODUCTSTYLE" 			AND "MP"."FIDPRODUCTMCLASS" = "M_ART"."FIDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_ART"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTSTORE"" M_PRDS ON" "TBL"."SKU" = M_PRDS."SKU" 	LEFT JOIN (SELECT 	"SKU" 	, COALESCE(SUM("QUANTITY"),0) "QUANTITY" 	FROM "TRAPODETAIL" 		WHERE ("TRANSNUMDO" IS NULL 			OR "TRANSNUMDO" = '' 			OR "TRANSNUMDO" NOT IN (SELECT 								T_DO."TRANSNUM" 								FROM WMS."TRDO" T_DO 									LEFT JOIN WMS."TRDR" T_DR 										ON T_DO."TRANSNUM" = T_DR."TRANSNUMDO" 								WHERE T_DR."TRANSSTATUS" = 9)) 			AND "TRANSSTATUS" <> -1 	GROUP BY "SKU") T_APO 			ON TBL."SKU" = T_APO."SKU" 		WHERE  1=1  AND "TBL"."ENDQTY" <> 0) T_ALL ) T_FINAL 	WHERE  1=1  	ORDER BY "SKU" ASC ---"SKU" ASC 	OFFSET 0.0000 LIMIT 10000.0000%'
			OR UPPER("Handpone") LIKE '%		SELECT T_FINAL.* 		FROM 		(SELECT T_ALL.*,  			CAST(CASE  			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO" > T_ALL."STOCKMIN" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" <= "T_ALL"."STOCKMINLV1") AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN1' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO" = "T_ALL"."STOCKMINLV2" AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN2' 			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO"> = "T_ALL"."STOCKMINLV3" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" < "T_ALL"."STOCKMINLV2") AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MIN3' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO"<T_ALL."STOCKMINLV3" AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN4' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO" = "T_ALL"."STOCKMAXLV1" AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MAX1' 			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO" > T_ALL."STOCKMAXLV1" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" <= "T_ALL"."STOCKMAXLV2") AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MAX2' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO">T_ALL."STOCKMAXLV2" AND T_ALL."PRODUCTTYPE"=2 THEN 'MAX3' 			ELSE '' 	END AS VARCHAR(16)) "STYPE" 		FROM 		(SELECT CAST(0 AS INTEGER) AS NRECNO 			,M_CAT."DESCRIPTION" "CATDESC" 			,TBL."SKU" 			,MP."DESCRIPTION" 			,TBL."GROSSSALES" 			,TBL."ENDQTY" 			,M_PRDS."STOCKMIN" 			,M_PRDS."STOCKMAX" 			,CAST(CASE WHEN M_PRDS."STOCKMAX"-TBL."ENDQTY"-COALESCE(T_APO."QUANTITY",0) < 0 THEN 0 				ELSE M_PRDS."STOCKMAX"-TBL."ENDQTY"-COALESCE(T_APO."QUANTITY",0) END AS NUMERIC(16)) AS "QTYORDER" 			,COALESCE(T_APO."QUANTITY",0) "QTYAPO" 			,CAST(TBL."GROSSSALES" * TBL."ENDQTY" AS NUMERIC(25,2)) AS "TOTAL" 			,TBL."TRANSDATE"			 			,M_CLASS."DESCRIPTION" "CLASSDESC" 			,M_STY."DESCRIPTION" "STYLEDESC" 			,M_ART."DESCRIPTION" "ARTICLEDESC" 			,CAST(M_PRDS."STOCKMIN"*1.2 AS NUMERIC(16))"STOCKMINLV1" 			,CAST(M_PRDS."STOCKMIN"*1 AS NUMERIC(16))"STOCKMINLV2" 			,CAST(M_PRDS."STOCKMIN"*0.8 AS NUMERIC(16))"STOCKMINLV3" 			,CAST(M_PRDS."STOCKMAX"*1 AS NUMERIC(16))"STOCKMAXLV1" 			,CAST(M_PRDS."STOCKMAX"*1.5 AS NUMERIC(16))"STOCKMAXLV2"		 			,MP."PRODUCTTYPE" 			FROM (SELECT * 			FROM "TRSTOCK" 				WHERE "STORECODE" = 'Z022') TBL 	JOIN (SELECT "SKU",MAX("TRANSDATE") AS "TRANSDATE" 			FROM "TRSTOCK" 			WHERE "TRANSDATE" < = '20200313' 				AND "STORECODE" = 'Z022' 			GROUP BY "SKU") PERIOD 		ON TBL."SKU" = "PERIOD"."SKU" AND "TBL"."TRANSDATE"" = PERIOD"."TRANSDATE"" LEFT JOIN ""MSPRODUCT"" MP ON TBL"."SKU"" = MP"."SKU"" LEFT JOIN ""MSPRODUCTCATEGORY"" M_CAT ON MP"."FIDPRODUCTCATEGORY"" = M_CAT"."IDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTMCLASS"" M_CLASS ON" "MP"."FIDPRODUCTMCLASS" = "M_CLASS"."IDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_CLASS"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTSTYLE"" M_STY ON" "MP"."FIDPRODUCTSTYLE" = "M_STY"."IDPRODUCTSTYLE" 			AND "MP"."FIDPRODUCTMCLASS" = "M_STY"."FIDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_STY"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTARTICLE"" M_ART ON" "MP"."FIDPRODUCTARTICLE" = "M_ART"."IDPRODUCTARTICLE" 			AND "MP"."FIDPRODUCTSTYLE" = "M_ART"."FIDPRODUCTSTYLE" 			AND "MP"."FIDPRODUCTMCLASS" = "M_ART"."FIDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_ART"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTSTORE"" M_PRDS ON" "TBL"."SKU" = M_PRDS."SKU" 	LEFT JOIN (SELECT 	"SKU" 	, COALESCE(SUM("QUANTITY"),0) "QUANTITY" 	FROM "TRAPODETAIL" 		WHERE ("TRANSNUMDO" IS NULL 			OR "TRANSNUMDO" = '' 			OR "TRANSNUMDO" NOT IN (SELECT 								T_DO."TRANSNUM" 								FROM WMS."TRDO" T_DO 									LEFT JOIN WMS."TRDR" T_DR 										ON T_DO."TRANSNUM" = T_DR."TRANSNUMDO" 								WHERE T_DR."TRANSSTATUS" = 9)) 			AND "TRANSSTATUS" <> -1 	GROUP BY "SKU") T_APO 			ON TBL."SKU" = T_APO."SKU" 		WHERE  1=1  AND "TBL"."ENDQTY" <> 0) T_ALL ) T_FINAL 	WHERE  1=1  	ORDER BY "SKU" ASC ---"SKU" ASC 	OFFSET 0.0000 LIMIT 10000.0000%'
			OR UPPER("Email") LIKE '%		SELECT T_FINAL.* 		FROM 		(SELECT T_ALL.*,  			CAST(CASE  			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO" > T_ALL."STOCKMIN" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" <= "T_ALL"."STOCKMINLV1") AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN1' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO" = "T_ALL"."STOCKMINLV2" AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN2' 			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO"> = "T_ALL"."STOCKMINLV3" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" < "T_ALL"."STOCKMINLV2") AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MIN3' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO"<T_ALL."STOCKMINLV3" AND T_ALL."PRODUCTTYPE"=2 THEN 'MIN4' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO" = "T_ALL"."STOCKMAXLV1" AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MAX1' 			WHEN (T_ALL."ENDQTY"+T_ALL."QTYAPO" > T_ALL."STOCKMAXLV1" AND "T_ALL"."ENDQTY""+T_ALL"."QTYAPO" <= "T_ALL"."STOCKMAXLV2") AND "T_ALL"."PRODUCTTYPE" = 2 THEN 'MAX2' 			WHEN T_ALL."ENDQTY"+T_ALL."QTYAPO">T_ALL."STOCKMAXLV2" AND T_ALL."PRODUCTTYPE"=2 THEN 'MAX3' 			ELSE '' 	END AS VARCHAR(16)) "STYPE" 		FROM 		(SELECT CAST(0 AS INTEGER) AS NRECNO 			,M_CAT."DESCRIPTION" "CATDESC" 			,TBL."SKU" 			,MP."DESCRIPTION" 			,TBL."GROSSSALES" 			,TBL."ENDQTY" 			,M_PRDS."STOCKMIN" 			,M_PRDS."STOCKMAX" 			,CAST(CASE WHEN M_PRDS."STOCKMAX"-TBL."ENDQTY"-COALESCE(T_APO."QUANTITY",0) < 0 THEN 0 				ELSE M_PRDS."STOCKMAX"-TBL."ENDQTY"-COALESCE(T_APO."QUANTITY",0) END AS NUMERIC(16)) AS "QTYORDER" 			,COALESCE(T_APO."QUANTITY",0) "QTYAPO" 			,CAST(TBL."GROSSSALES" * TBL."ENDQTY" AS NUMERIC(25,2)) AS "TOTAL" 			,TBL."TRANSDATE"			 			,M_CLASS."DESCRIPTION" "CLASSDESC" 			,M_STY."DESCRIPTION" "STYLEDESC" 			,M_ART."DESCRIPTION" "ARTICLEDESC" 			,CAST(M_PRDS."STOCKMIN"*1.2 AS NUMERIC(16))"STOCKMINLV1" 			,CAST(M_PRDS."STOCKMIN"*1 AS NUMERIC(16))"STOCKMINLV2" 			,CAST(M_PRDS."STOCKMIN"*0.8 AS NUMERIC(16))"STOCKMINLV3" 			,CAST(M_PRDS."STOCKMAX"*1 AS NUMERIC(16))"STOCKMAXLV1" 			,CAST(M_PRDS."STOCKMAX"*1.5 AS NUMERIC(16))"STOCKMAXLV2"		 			,MP."PRODUCTTYPE" 			FROM (SELECT * 			FROM "TRSTOCK" 				WHERE "STORECODE" = 'Z022') TBL 	JOIN (SELECT "SKU",MAX("TRANSDATE") AS "TRANSDATE" 			FROM "TRSTOCK" 			WHERE "TRANSDATE" < = '20200313' 				AND "STORECODE" = 'Z022' 			GROUP BY "SKU") PERIOD 		ON TBL."SKU" = "PERIOD"."SKU" AND "TBL"."TRANSDATE"" = PERIOD"."TRANSDATE"" LEFT JOIN ""MSPRODUCT"" MP ON TBL"."SKU"" = MP"."SKU"" LEFT JOIN ""MSPRODUCTCATEGORY"" M_CAT ON MP"."FIDPRODUCTCATEGORY"" = M_CAT"."IDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTMCLASS"" M_CLASS ON" "MP"."FIDPRODUCTMCLASS" = "M_CLASS"."IDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_CLASS"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTSTYLE"" M_STY ON" "MP"."FIDPRODUCTSTYLE" = "M_STY"."IDPRODUCTSTYLE" 			AND "MP"."FIDPRODUCTMCLASS" = "M_STY"."FIDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_STY"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTARTICLE"" M_ART ON" "MP"."FIDPRODUCTARTICLE" = "M_ART"."IDPRODUCTARTICLE" 			AND "MP"."FIDPRODUCTSTYLE" = "M_ART"."FIDPRODUCTSTYLE" 			AND "MP"."FIDPRODUCTMCLASS" = "M_ART"."FIDPRODUCTMCLASS" 			AND "MP"."FIDPRODUCTCATEGORY"" = M_ART"."FIDPRODUCTCATEGORY"" LEFT JOIN ""MSPRODUCTSTORE"" M_PRDS ON" "TBL"."SKU" = M_PRDS."SKU" 	LEFT JOIN (SELECT 	"SKU" 	, COALESCE(SUM("QUANTITY"),0) "QUANTITY" 	FROM "TRAPODETAIL" 		WHERE ("TRANSNUMDO" IS NULL 			OR "TRANSNUMDO" = '' 			OR "TRANSNUMDO" NOT IN (SELECT 								T_DO."TRANSNUM" 								FROM WMS."TRDO" T_DO 									LEFT JOIN WMS."TRDR" T_DR 										ON T_DO."TRANSNUM" = T_DR."TRANSNUMDO" 								WHERE T_DR."TRANSSTATUS" = 9)) 			AND "TRANSSTATUS" <> -1 	GROUP BY "SKU") T_APO 			ON TBL."SKU" = T_APO."SKU" 		WHERE  1=1  AND TBL."ENDQTY" <> 0) T_ALL ) T_FINAL 	WHERE  1=1  	ORDER BY "SKU" ASC ---"SKU" ASC 	OFFSET 0.0000 LIMIT 10000.0000%'
		)
 LIMIT 1
ERROR - 2020-03-13 11:50:25 --> Severity: error --> Exception: Call to a member function num_rows() on boolean /home/elcorps/crm/adm/application/models/Base_model.php 84
